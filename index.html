<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fakester</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p id="loading-message">Lade...</p>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <div id="confirm-action-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 id="confirm-action-title">Aktion best√§tigen</h3>
            <p id="confirm-action-message">Bist du sicher, dass du diese Aktion ausf√ºhren m√∂chtest?</p>
            <div class="modal-actions">
                <button id="confirm-action-cancel-btn" class="button-secondary">Abbrechen</button>
                <button id="confirm-action-confirm-btn" class="button-primary">Best√§tigen</button>
            </div>
        </div>
    </div>

    <div id="join-room-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Raum beitreten</h3>
            <p>Gib den 4-stelligen PIN ein:</p>
            <div class="pin-input-display">
                <span class="pin-digit"></span>
                <span class="pin-digit"></span>
                <span class="pin-digit"></span>
                <span class="pin-digit"></span>
            </div>
            <div class="numpad" id="join-room-numpad">
                <button class="numpad-button" data-key="1">1</button>
                <button class="numpad-button" data-key="2">2</button>
                <button class="numpad-button" data-key="3">3</button>
                <button class="numpad-button" data-key="4">4</button>
                <button class="numpad-button" data-key="5">5</button>
                <button class="numpad-button" data-key="6">6</button>
                <button class="numpad-button" data-key="7">7</button>
                <button class="numpad-button" data-key="8">8</button>
                <button class="numpad-button" data-key="9">9</button>
                <button class="numpad-button" data-action="clear"><i class="fa-solid fa-xmark"></i></button>
                <button class="numpad-button" data-key="0">0</button>
                <button class="numpad-button" data-action="backspace"><i class="fa-solid fa-backspace"></i></button>
                <button class="numpad-button confirm" data-action="confirm" disabled><i class="fa-solid fa-check"></i></button>
            </div>
            <button class="button-secondary button-exit-modal">Abbrechen</button>
        </div>
    </div>

    <div id="guest-login-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Als Gast spielen</h3>
            <p>Gib einen Nickname ein:</p>
            <input type="text" id="guest-nickname-input" placeholder="Dein Nickname" minlength="3" maxlength="15">
            <div class="modal-actions">
                <button id="guest-login-submit-btn" class="button-primary">Spielen</button>
                <button id="guest-login-close-btn" class="button-secondary">Abbrechen</button>
            </div>
        </div>
    </div>

    <div id="leave-game-confirm-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Spiel verlassen?</h3>
            <p>M√∂chtest du das aktuelle Spiel wirklich verlassen? Dein Fortschritt geht dabei verloren.</p>
            <div class="modal-actions">
                <button id="leave-game-cancel-btn" class="button-secondary">Abbrechen</button>
                <button id="leave-game-confirm-btn" class="button-primary">Verlassen</button>
            </div>
        </div>
    </div>

    <div id="change-name-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Nickname √§ndern</h3>
            <p>Gib deinen neuen Nickname ein:</p>
            <input type="text" id="change-name-input" placeholder="Neuer Nickname" minlength="3" maxlength="15">
            <div class="modal-actions">
                <button id="change-name-submit-btn" class="button-primary">Speichern</button>
                <button class="button-secondary button-exit-modal">Abbrechen</button>
            </div>
        </div>
    </div>

    <div id="device-select-modal" class="modal-overlay hidden">
        <div class="modal-content modal-scrollable">
            <h3>Ger√§t ausw√§hlen</h3>
            <p>W√§hle ein Ger√§t, auf dem Spotify l√§uft:</p>
            <button id="device-select-refresh-btn" class="button-secondary button-small"><i class="fa-solid fa-arrows-rotate"></i> Aktualisieren</button>
            <ul id="device-list" class="item-list">
                <li>Lade Ger√§te...</li>
            </ul>
            <button class="button-secondary button-exit-modal">Schlie√üen</button>
        </div>
    </div>

    <div id="playlist-select-modal" class="modal-overlay hidden">
        <div class="modal-content modal-scrollable">
            <h3>Playlist ausw√§hlen</h3>
            <input type="text" id="playlist-search-input" placeholder="Playlist suchen..." class="search-input">
            <ul id="playlist-list" class="item-list">
                <li>Lade Playlists...</li>
            </ul>
            <div id="playlist-pagination" class="pagination-controls"></div>
            <button class="button-secondary button-exit-modal">Schlie√üen</button>
        </div>
    </div>
    
    <div id="bg-color-select-modal" class="modal-overlay hidden">
        <div class="modal-content modal-scrollable">
            <h3>Hintergrundfarbe w√§hlen</h3>
            <ul id="bg-color-list" class="item-list grid-list">
                </ul>
            <button class="button-secondary button-exit-modal">Schlie√üen</button>
        </div>
    </div>

    <div id="bg-symbol-select-modal" class="modal-overlay hidden">
        <div class="modal-content modal-scrollable">
            <h3>Hintergrundsymbol w√§hlen</h3>
            <ul id="bg-symbol-list" class="item-list grid-list">
                </ul>
            <button class="button-secondary button-exit-modal">Schlie√üen</button>
        </div>
    </div>

    <div id="friends-modal" class="modal-overlay hidden">
        <div class="modal-content modal-large">
            <h3>Freunde</h3>
            <div class="tab-container">
                <div class="tabs" id="friends-tabs">
                    <button class="tab-button active" data-tab="friends-list-tab">Deine Freunde</button>
                    <button class="tab-button" data-tab="friend-requests-tab">Anfragen</button>
                    <button class="tab-button" data-tab="add-friend-tab">Freund hinzuf√ºgen</button>
                </div>
                <div class="tab-content-container">
                    <div id="friends-list-tab" class="tab-content active">
                        <ul id="friends-list" class="item-list">
                            <li>Lade Freunde...</li>
                        </ul>
                    </div>
                    <div id="friend-requests-tab" class="tab-content">
                        <ul id="friend-requests-list" class="item-list">
                            <li>Keine Anfragen.</li>
                        </ul>
                    </div>
                    <div id="add-friend-tab" class="tab-content">
                        <input type="text" id="add-friend-input" placeholder="Nickname des Freundes">
                        <button id="add-friend-btn" class="button-primary">Senden</button>
                    </div>
                </div>
            </div>
            <button class="button-secondary button-exit-modal">Schlie√üen</button>
        </div>
    </div>

    <div id="custom-value-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 id="custom-value-title">Wert eingeben</h3>
            <input type="number" id="custom-value-input" value="1" min="1" max="10" readonly>
            <div class="numpad" id="custom-value-numpad">
                <button class="numpad-button" data-key="1">1</button>
                <button class="numpad-button" data-key="2">2</button>
                <button class="numpad-button" data-key="3">3</button>
                <button class="numpad-button" data-key="4">4</button>
                <button class="numpad-button" data-key="5">5</button>
                <button class="numpad-button" data-key="6">6</button>
                <button class="numpad-button" data-key="7">7</button>
                <button class="numpad-button" data-key="8">8</button>
                <button class="numpad-button" data-key="9">9</button>
                <button class="numpad-button" data-action="clear"><i class="fa-solid fa-xmark"></i></button>
                <button class="numpad-button" data-key="0">0</button>
                <button class="numpad-button" data-action="backspace"><i class="fa-solid fa-backspace"></i></button>
            </div>
            <div class="modal-actions">
                <button id="custom-value-confirm-btn" class="button-primary">Best√§tigen</button>
                <button class="button-secondary button-exit-modal">Abbrechen</button>
            </div>
        </div>
    </div>


    <div class="screen-container">
        <div id="auth-screen" class="screen active">
            <div class="auth-card">
                <h2>Fakester</h2>
                <form id="login-form">
                    <h3>Login</h3>
                    <input type="email" id="login-email" placeholder="Email" required>
                    <input type="password" id="login-password" placeholder="Passwort" required>
                    <button type="submit" class="button-primary">Einloggen</button>
                    <p>Noch kein Konto? <a href="#" id="show-register">Registrieren</a></p>
                </form>
                <form id="register-form" class="hidden">
                    <h3>Registrieren</h3>
                    <input type="text" id="register-username" placeholder="Nickname" required minlength="3" maxlength="15">
                    <input type="email" id="register-email" placeholder="Email" required>
                    <input type="password" id="register-password" placeholder="Passwort" required>
                    <button type="submit" class="button-primary">Registrieren</button>
                    <p>Bereits ein Konto? <a href="#" id="show-login">Einloggen</a></p>
                </form>
                <button id="guest-login-btn" class="button-secondary mt-2">Als Gast spielen</button>
            </div>
        </div>

        <div id="home-screen" class="screen hidden">
            <header class="app-header">
                <div class="profile-info">
                    <button id="profile-picture-btn" class="profile-picture">
                        <i id="profile-icon" class="fa-solid fa-user"></i>
                    </button>
                    <div>
                        <span id="profile-username" class="username"></span>
                        <span id="profile-title" class="user-title">Neuling</span>
                    </div>
                </div>
                <div class="progress-bar-container">
                    <span id="profile-level" class="level-indicator">1</span>
                    <div class="xp-bar-wrapper">
                        <div id="profile-xp-fill" class="xp-bar-fill"></div>
                    </div>
                    <span id="profile-xp-text" class="xp-text">0 / 100 XP</span>
                </div>
                <div class="spots-info">
                    <i class="fa-solid fa-coins"></i> <span id="user-spots">0</span>
                </div>
            </header>
            
            <div class="main-menu">
                <button id="create-room-btn" class="menu-button"><i class="fa-solid fa-plus-circle"></i> Raum erstellen</button>
                <button id="join-room-btn" class="menu-button"><i class="fa-solid fa-right-to-bracket"></i> Raum beitreten</button>
                <button id="spotify-connect-btn" class="menu-button button-spotify hidden"><i class="fa-brands fa-spotify"></i> Spotify verbinden</button>
                <button id="customization-btn" class="menu-button"><i class="fa-solid fa-palette"></i> Anpassung</button>
                <button id="shop-button" class="menu-button"><i class="fa-solid fa-store"></i> Shop</button>
                <button id="friends-btn" class="menu-button"><i class="fa-solid fa-users"></i> Freunde</button>
                <button id="stats-btn" class="menu-button"><i class="fa-solid fa-chart-line"></i> Statistiken</button>
                <button id="achievements-btn" class="menu-button"><i class="fa-solid fa-medal"></i> Erfolge</button>
                <button id="level-progress-btn" class="menu-button"><i class="fa-solid fa-arrow-up"></i> Level & Belohnungen</button>
                <button id="logout-btn" class="menu-button button-secondary"><i class="fa-solid fa-right-from-bracket"></i> Abmelden</button>
            </div>
        </div>

        <div id="mode-selection-screen" class="screen hidden">
            <h2 class="screen-title">W√§hle einen Spielmodus</h2>
            <div id="mode-boxes-container" class="mode-selection-grid">
                <button class="mode-box" data-mode="quiz">
                    <h3>Quiz</h3>
                    <p>Errate den Songtitel oder Interpreten</p>
                    <i class="fa-solid fa-music"></i>
                </button>
                <button class="mode-box disabled">
                    <h3>Fakester (bald)</h3>
                    <p>Wahrheit oder L√ºge</p>
                    <i class="fa-solid fa-mask"></i>
                </button>
                <button class="mode-box disabled">
                    <h3>Wahrheit (bald)</h3>
                    <p>Erfinde die coolste Antwort</p>
                    <i class="fa-solid fa-lightbulb"></i>
                </button>
            </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>

        <div id="game-type-selection-screen" class="screen hidden">
            <h2 class="screen-title">Spieltyp ausw√§hlen</h2>
            <div class="game-type-selection">
                <div class="game-type-options">
                    <button id="game-type-points-btn" class="button-secondary active">
                        <i class="fa-solid fa-star"></i> Punkte
                    </button>
                    <button id="game-type-lives-btn" class="button-secondary">
                        <i class="fa-solid fa-heart"></i> Leben
                    </button>
                </div>

                <div id="game-type-lives-settings" class="game-type-settings hidden">
                    <h4>Anzahl Leben</h4>
                    <div id="lives-presets" class="preset-group">
                        <button class="preset-button active" data-value="3">3 Leben</button>
                        <button class="preset-button" data-value="5">5 Leben</button>
                        <button class="preset-button" data-value="custom">Custom</button>
                    </div>
                </div>
            </div>
            <button id="create-lobby-btn" class="button-primary" disabled>Lobby erstellen</button>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>

        <div id="lobby-screen" class="screen hidden">
            <header class="lobby-header">
                <h2 id="lobby-pin">PIN: ----</h2>
                <div class="lobby-actions">
                    <button id="invite-friends-btn" class="button-secondary"><i class="fa-solid fa-user-plus"></i> Freunde einladen</button>
                    <button id="leave-game-btn" class="button-secondary"><i class="fa-solid fa-door-open"></i> Lobby verlassen</button>
                </div>
            </header>

            <div class="lobby-content">
                <div class="player-list-container">
                    <h3>Spieler (<span id="player-count">0</span>/<span id="max-players">8</span>)</h3>
                    <div id="player-list" class="player-list">
                        </div>
                    <div class="player-reactions">
                        <button class="reaction-btn" data-reaction="üëç">üëç</button>
                        <button class="reaction-btn" data-reaction="üòÇ">üòÇ</button>
                        <button class="reaction-btn" data-reaction="‚ù§Ô∏è">‚ù§Ô∏è</button>
                        <button class="reaction-btn" data-reaction="ü§î">ü§î</button>
                    </div>
                </div>

                <div id="host-settings" class="host-settings-panel">
                    <h3>Host Einstellungen</h3>
                    <div class="setting-item">
                        <label>Spotify Ger√§t:</label>
                        <button id="device-select-btn" class="button-select">Ger√§t ausw√§hlen</button>
                    </div>
                    <div class="setting-item">
                        <label>Playlist:</label>
                        <button id="playlist-select-btn" class="button-select">Playlist ausw√§hlen</button>
                    </div>
                    
                    <div class="setting-item">
                        <label>Lobby Hintergrund:</label>
                        <button id="bg-color-select-button" class="button-select">Farbe w√§hlen</button>
                        <button id="bg-symbol-select-button" class="button-select">Symbol w√§hlen</button>
                    </div>

                    <div id="quiz-settings">
                        <h4>Zu erraten:</h4>
                        <div id="guess-types-checkboxes" class="checkbox-group">
                            <label><input type="checkbox" value="title" checked> Titel</label>
                            <label><input type="checkbox" value="artist" checked> Interpret</label>
                        </div>
                        <p id="guess-types-error" class="error-message hidden">W√§hle mindestens eine Option.</p>
                    </div>

                    <button id="start-game-btn" class="button-primary" disabled>Spiel starten</button>
                </div>
            </div>
        </div>

        <div id="game-screen" class="screen hidden">
            <header class="game-header">
                <div class="game-info">
                    <span id="game-round-info">Runde 1/10</span>
                    <span id="game-timer">0:30</span>
                </div>
                <div class="game-player-list" id="game-player-list">
                    </div>
            </header>

            <div class="game-main-content">
                <div id="game-question-area" class="game-area">
                    <p id="game-question">Welches Lied l√§uft gerade?</p>
                </div>
                <div id="game-answer-input-area" class="game-area">
                    <input type="text" id="game-answer-input" placeholder="Deine Antwort hier...">
                    <button id="game-submit-answer-btn" class="button-primary">Senden</button>
                </div>
                <div id="game-results-area" class="game-area hidden">
                    <h3 id="round-result-title">Runde beendet!</h3>
                    <p id="correct-answer-display"></p>
                    <ul id="player-answers-list"></ul>
                </div>
            </div>

            <div class="game-reactions">
                <button class="reaction-btn" data-reaction="üëç">üëç</button>
                <button class="reaction-btn" data-reaction="üòÇ">üòÇ</button>
                <button class="reaction-btn" data-reaction="‚ù§Ô∏è">‚ù§Ô∏è</button>
                <button class="reaction-btn" data-reaction="ü§î">ü§î</button>
            </div>
            <button id="game-leave-btn" class="button-secondary leave-game-button"><i class="fa-solid fa-door-open"></i> Verlassen</button>
        </div>

        <div id="stats-screen" class="screen hidden">
            <h2 class="screen-title">Statistiken</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Gesamtspiele</h3>
                    <p id="stat-games-played">0</p>
                </div>
                <div class="stat-card">
                    <h3>Siege</h3>
                    <p id="stat-wins">0</p>
                </div>
                <div class="stat-card">
                    <h3>Siegquote</h3>
                    <p id="stat-winrate">0%</p>
                </div>
                <div class="stat-card">
                    <h3>H√∂chstpunktzahl</h3>
                    <p id="stat-highscore">0</p>
                </div>
                <div class="stat-card">
                    <h3>Korrekte Antworten</h3>
                    <p id="stat-correct-answers">0</p>
                </div>
                <div class="stat-card">
                    <h3>Durchschnittliche Punkte</h3>
                    <p id="stat-avg-score">0.0</p>
                </div>
            </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>

        <div id="achievements-screen" class="screen hidden">
            <h2 class="screen-title">Erfolge</h2>
            <div id="achievements-list" class="achievements-grid">
                </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>

        <div id="level-progress-screen" class="screen hidden">
            <h2 class="screen-title">Level & Belohnungen</h2>
            <div id="level-progress-list" class="level-progress-list">
                </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>

        <div id="customization-screen" class="screen hidden">
            <h2 class="screen-title">Anpassung</h2>
            <div class="tab-container">
                <div id="customization-tabs" class="tabs">
                    <button class="tab-button active" data-tab="custom-titles">Titel</button>
                    <button class="tab-button" data-tab="custom-icons">Icons</button>
                    <button class="tab-button" data-tab="custom-colors">Namensfarben</button>
                    <button class="tab-button" data-tab="custom-bg-colors">Hintergrundfarbe</button>
                    <button class="tab-button" data-tab="custom-bg-symbols">Hintergrundsymbol</button>
                </div>
                <div class="tab-content-container">
                    <div id="custom-titles" class="tab-content active modal-scrollable">
                        <h3>Deine Titel</h3>
                        <div id="custom-titles-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="custom-icons" class="tab-content modal-scrollable">
                        <h3>Deine Icons</h3>
                        <div id="custom-icons-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="custom-colors" class="tab-content modal-scrollable">
                        <h3>Deine Namensfarben</h3>
                        <div id="custom-colors-list" class="item-list grid-list">
                            </div>
                    </div>
                     <div id="custom-bg-colors" class="tab-content modal-scrollable">
                        <h3>Deine Lobby-Hintergrundfarben</h3>
                        <div id="custom-bg-colors-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="custom-bg-symbols" class="tab-content modal-scrollable">
                        <h3>Deine Lobby-Hintergrundsymbole</h3>
                        <div id="custom-bg-symbols-list" class="item-list grid-list">
                            </div>
                    </div>
                </div>
            </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>
        
        <div id="shop-screen" class="screen hidden">
            <h2 class="screen-title">Shop</h2>
            <div class="spots-info-shop">
                <i class="fa-solid fa-coins"></i> <span id="user-spots-shop">0</span> Spots
            </div>
            <div class="tab-container">
                <div id="shop-tabs" class="tabs">
                    <button class="tab-button active" data-tab="shop-titles">Titel</button>
                    <button class="tab-button" data-tab="shop-icons">Icons</button>
                    <button class="tab-button" data-tab="shop-colors">Namensfarben</button>
                    <button class="tab-button" data-tab="shop-bg-colors">Hintergrundfarben</button>
                    <button class="tab-button" data-tab="shop-bg-symbols">Hintergrundsymbole</button>
                </div>
                <div class="tab-content-container">
                    <div id="shop-titles" class="tab-content active modal-scrollable">
                        <h3>Titel zum Kaufen</h3>
                        <div id="shop-titles-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="shop-icons" class="tab-content modal-scrollable">
                        <h3>Icons zum Kaufen</h3>
                        <div id="shop-icons-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="shop-colors" class="tab-content modal-scrollable">
                        <h3>Namensfarben zum Kaufen</h3>
                        <div id="shop-colors-list" class="item-list grid-list">
                            </div>
                    </div>
                     <div id="shop-bg-colors" class="tab-content modal-scrollable">
                        <h3>Hintergrundfarben zum Kaufen</h3>
                        <div id="shop-bg-colors-list" class="item-list grid-list">
                            </div>
                    </div>
                    <div id="shop-bg-symbols" class="tab-content modal-scrollable">
                        <h3>Hintergrundsymbole zum Kaufen</h3>
                        <div id="shop-bg-symbols-list" class="item-list grid-list">
                            </div>
                    </div>
                </div>
            </div>
            <button class="button-back" onclick="goBack()"><i class="fa-solid fa-arrow-left"></i> Zur√ºck</button>
        </div>


    </div> <div id="on-page-console" class="on-page-console hidden">
        <div class="console-header">
            <span>Konsole</span>
            <div class="console-controls">
                <button id="clear-console-btn" class="button-small">Clear</button>
                <button id="copy-console-btn" class="button-small">Copy</button>
                <button id="close-console-btn" class="button-small"><i class="fa-solid fa-xmark"></i></button>
            </div>
        </div>
        <div id="console-output" class="console-output"></div>
    </div>
    <button id="toggle-console-btn" class="toggle-console-button"><i class="fa-solid fa-terminal"></i></button>

    <script src="/script.js"></script>
</body>
</html>
